<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>vinecopulib::RVineStructure class | vinecopulib A C++ library for vine copulas</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark+documentation.compiled.css" />
  <link rel="icon" href="favicon-dark.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">vinecopulib <span class="m-thin">A C++ library for vine copulas</span></a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path d="m6 0c-3.3144 0-6 2.6856-6 6 0 3.3144 2.6856 6 6 6 1.4858 0 2.8463-0.54083 3.8945-1.4355-0.0164 0.33797 0.14734 0.75854 0.5 1.1504l3.2227 3.7891c0.55185 0.6139 1.4517 0.66544 2.002 0.11524 0.55022-0.55022 0.49866-1.4501-0.11524-2.002l-3.7891-3.2246c-0.39184-0.35266-0.81242-0.51469-1.1504-0.5 0.89472-1.0482 1.4355-2.4088 1.4355-3.8945 0-3.3128-2.6856-5.998-6-5.998zm0 1.5625a4.4375 4.4375 0 0 1 4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375-4.4375 4.4375 4.4375 0 0 1 4.4375-4.4375z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="setup.html">Setup</a></li>
            <li>
              <a href="overview.html">Overview</a>
              <ol>
                <li><a href="overview-bicop.html">Bivariate copula models</a></li>
                <li><a href="overview-vinecop.html">Vine copula models</a></li>
              </ol>
            </li>
            <li>
              <a href="annotated.html">Classes</a>
              <ol>
                <li><a href="classvinecopulib_1_1_bicop.html">vinecopulib::Bicop</a></li>
                <li><a href="classvinecopulib_1_1_fit_controls_bicop.html">vinecopulib::FitControlsBicop</a></li>
                <li><a href="classvinecopulib_1_1_vinecop.html">vinecopulib::Vinecop</a></li>
                <li><a href="classvinecopulib_1_1_fit_controls_vinecop.html">vinecopulib::FitControlsVinecop</a></li>
                <li><a href="classvinecopulib_1_1_r_vine_structure.html" id="m-navbar-current">vinecopulib::RVineStructure</a></li>
                <li><a href="classvinecopulib_1_1_triangular_array.html">vinecopulib::TriangularArray</a></li>
              </ol>
            </li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="4">
            <li>
              <a href="namespaces.html">Namespaces</a>
              <ol>
                <li><a href="namespacevinecopulib.html">vinecopulib</a></li>
                <li><a href="namespacevinecopulib_1_1bicop__families.html">vinecopulib::bicop_families</a></li>
                <li><a href="namespacevinecopulib_1_1tools__stats.html">vinecopulib::tools_stats</a></li>
              </ol>
            </li>
            <li><a href="license.html">License</a></li>
            <li><a href="https://github.com/vinecopulib/vinecopulib">GitHub</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <path d="m6 0c-3.3144 0-6 2.6856-6 6 0 3.3144 2.6856 6 6 6 1.4858 0 2.8463-0.54083 3.8945-1.4355-0.0164 0.33797 0.14734 0.75854 0.5 1.1504l3.2227 3.7891c0.55185 0.6139 1.4517 0.66544 2.002 0.11524 0.55022-0.55022 0.49866-1.4501-0.11524-2.002l-3.7891-3.2246c-0.39184-0.35266-0.81242-0.51469-1.1504-0.5 0.89472-1.0482 1.4355-2.4088 1.4355-3.8945 0-3.3128-2.6856-5.998-6-5.998zm0 1.5625a4.4375 4.4375 0 0 1 4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375-4.4375 4.4375 4.4375 0 0 1 4.4375-4.4375z"/>
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="namespacevinecopulib.html">vinecopulib</a>::<wbr/></span>RVineStructure <span class="m-thin">class</span>
        </h1>
        <p>R-vine structures.</p>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li>
              Reference
              <ul>
                <li><a href="#derived-classes">Derived classes</a></li>
                <li><a href="#pub-static-methods">Public static functions</a></li>
                <li><a href="#typeless-methods">Constructors, destructors, conversion operators</a></li>
                <li><a href="#pub-methods">Public functions</a></li>
              </ul>
            </li>
          </ul>
        </div>
<p><a href="classvinecopulib_1_1_r_vine_structure.html" class="m-doc">RVineStructure</a> objects encode the tree structure of the vine, i.e. the conditioned/conditioning variables of each edge. It is represented by a triangular array. An exemplary array is</p><pre class="m-code"><span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span>
<span class="mi">3</span> <span class="mi">3</span> <span class="mi">3</span>
<span class="mi">2</span> <span class="mi">2</span>
<span class="mi">1</span></pre><p>which encodes the following pair-copulas:</p><pre class="m-code"><span class="o">|</span> <span class="n">tree</span> <span class="o">|</span> <span class="n">edge</span> <span class="o">|</span> <span class="n">pair</span><span class="o">-</span><span class="n">copulas</span>   <span class="o">|</span>
<span class="o">|------|------|----------------|</span>
<span class="o">|</span> <span class="mi">0</span>    <span class="o">|</span> <span class="mi">0</span>    <span class="o">|</span> <span class="err">`</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="err">`</span>       <span class="o">|</span>
<span class="o">|</span>      <span class="o">|</span> <span class="mi">1</span>    <span class="o">|</span> <span class="err">`</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="err">`</span>       <span class="o">|</span>
<span class="o">|</span>      <span class="o">|</span> <span class="mi">2</span>    <span class="o">|</span> <span class="err">`</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="err">`</span>       <span class="o">|</span>
<span class="o">|</span> <span class="mi">1</span>    <span class="o">|</span> <span class="mi">0</span>    <span class="o">|</span> <span class="err">`</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">;</span> <span class="mi">4</span><span class="p">)</span><span class="err">`</span>    <span class="o">|</span>
<span class="o">|</span>      <span class="o">|</span> <span class="mi">1</span>    <span class="o">|</span> <span class="err">`</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">;</span> <span class="mi">4</span><span class="p">)</span><span class="err">`</span>    <span class="o">|</span>
<span class="o">|</span> <span class="mi">2</span>    <span class="o">|</span> <span class="mi">0</span>    <span class="o">|</span> <span class="err">`</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">;</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="err">`</span> <span class="o">|</span></pre><p>Denoting by <code>M[i, j]</code> the array entry in row <code>i</code> and column <code>j</code>, the pair-copula index for edge <code>e</code> in tree <code>t</code> of a <code>d</code> dimensional vine is <code>(M[d - 1 - e, e], M[t, e]; M[t - 1, e], ..., M[0, e])</code>. Less formally,</p><ol><li>Start with the counter-diagonal element of column <code>e</code> (first conditioned variable).</li><li>Jump up to the element in row <code>t</code> (second conditioned variable).</li><li>Gather all entries further up in column <code>e</code> (conditioning set).</li></ol><p>A valid R-vine array must satisfy several conditions which are checked when <code><a href="classvinecopulib_1_1_r_vine_structure.html#a00a8ce5a6d6a18a2dc0b38afe4749691" class="m-doc">RVineStructure()</a></code> is called:</p><ol><li>It only contains numbers between 1 and d.</li><li>The diagonal must contain the numbers 1, ..., d.</li><li>The diagonal entry of a column must not be contained in any column further to the right.</li><li>The entries of a column must be contained in all columns to the left.</li><li>The proximity condition must hold: For all t = 1, ..., d - 2 and e = 0, ..., d - t - 1 there must exist an index j &gt; d, such that <code>(M[t, e], {M[0, e], ..., M[t-1, e]})</code> equals either <code>(M[d-j-1, j], {M[0, j], ..., M[t-1, j]})</code> or <code>(M[t-1, j], {M[d-j-1, j], M[0, j], ..., M[t-2, j]})</code>.</li></ol><p>An R-vine array is said to be in natural order when the anti-diagonal entries are <svg class="m-math" style="width: 3.975em; height: 1.107em; vertical-align: -0.243em;" viewBox="0 -8.30219 38.1565 10.6268">
<title>
$ 1, \dots, d $
</title>
<defs>
<path d='M2.19975 -0.573848C2.19975 -0.920548 1.91283 -1.15965 1.6259 -1.15965C1.2792 -1.15965 1.0401 -0.872727 1.0401 -0.585803C1.0401 -0.239103 1.32702 0 1.61395 0C1.96065 0 2.19975 -0.286924 2.19975 -0.573848Z' id='eq1-g0-58'/>
<path d='M2.33126 0.0478207C2.33126 -0.645579 2.10411 -1.15965 1.61395 -1.15965C1.23138 -1.15965 1.0401 -0.848817 1.0401 -0.585803S1.21943 0 1.6259 0C1.78132 0 1.91283 -0.0478207 2.02042 -0.155417C2.04433 -0.179328 2.05629 -0.179328 2.06824 -0.179328C2.09215 -0.179328 2.09215 -0.0119552 2.09215 0.0478207C2.09215 0.442341 2.02042 1.21943 1.32702 1.99651C1.19552 2.13998 1.19552 2.16389 1.19552 2.1878C1.19552 2.24757 1.25529 2.30735 1.31507 2.30735C1.41071 2.30735 2.33126 1.42267 2.33126 0.0478207Z' id='eq1-g0-59'/>
<path d='M6.01345 -7.99801C6.0254 -8.04583 6.04932 -8.11756 6.04932 -8.17733C6.04932 -8.29689 5.92976 -8.29689 5.90585 -8.29689C5.8939 -8.29689 5.30809 -8.24907 5.24832 -8.23711C5.04508 -8.22516 4.86575 -8.20125 4.65056 -8.18929C4.35168 -8.16538 4.268 -8.15342 4.268 -7.93823C4.268 -7.81868 4.36364 -7.81868 4.53101 -7.81868C5.11681 -7.81868 5.12877 -7.71108 5.12877 -7.59153C5.12877 -7.5198 5.10486 -7.42416 5.0929 -7.38829L4.36364 -4.48319C4.23213 -4.79402 3.90934 -5.27223 3.28767 -5.27223C1.93674 -5.27223 0.478207 -3.52677 0.478207 -1.75741C0.478207 -0.573848 1.17161 0.119552 1.98456 0.119552C2.64209 0.119552 3.20399 -0.394521 3.53873 -0.789041C3.65828 -0.0836862 4.22017 0.119552 4.57883 0.119552S5.22441 -0.0956413 5.4396 -0.526027C5.63088 -0.932503 5.79826 -1.66177 5.79826 -1.70959C5.79826 -1.76936 5.75044 -1.81719 5.6787 -1.81719C5.57111 -1.81719 5.55915 -1.75741 5.51133 -1.57808C5.332 -0.872727 5.10486 -0.119552 4.61469 -0.119552C4.268 -0.119552 4.24408 -0.430386 4.24408 -0.669489C4.24408 -0.71731 4.24408 -0.968369 4.32777 -1.30311L6.01345 -7.99801ZM3.59851 -1.42267C3.53873 -1.21943 3.53873 -1.19552 3.37136 -0.968369C3.10834 -0.633624 2.58232 -0.119552 2.02042 -0.119552C1.53026 -0.119552 1.25529 -0.561893 1.25529 -1.26725C1.25529 -1.92478 1.6259 -3.26376 1.85305 -3.76588C2.25953 -4.60274 2.82142 -5.03313 3.28767 -5.03313C4.07671 -5.03313 4.23213 -4.0528 4.23213 -3.95716C4.23213 -3.94521 4.19626 -3.78979 4.18431 -3.76588L3.59851 -1.42267Z' id='eq1-g0-100'/>
<path d='M3.44309 -7.66326C3.44309 -7.93823 3.44309 -7.95019 3.20399 -7.95019C2.91706 -7.6274 2.3193 -7.18506 1.08792 -7.18506V-6.83836C1.36289 -6.83836 1.96065 -6.83836 2.61818 -7.14919V-0.920548C2.61818 -0.490162 2.58232 -0.3467 1.53026 -0.3467H1.15965V0C1.48244 -0.0239103 2.64209 -0.0239103 3.03661 -0.0239103S4.57883 -0.0239103 4.90162 0V-0.3467H4.53101C3.47895 -0.3467 3.44309 -0.490162 3.44309 -0.920548V-7.66326Z' id='eq1-g1-49'/>
</defs>
<g id='eq1-page1'>
<use x='0' xlink:href='#eq1-g1-49' y='0'/>
<use x='5.85299' xlink:href='#eq1-g0-59' y='0'/>
<use x='11.0971' xlink:href='#eq1-g0-58' y='0'/>
<use x='16.3413' xlink:href='#eq1-g0-58' y='0'/>
<use x='21.5855' xlink:href='#eq1-g0-58' y='0'/>
<use x='26.8296' xlink:href='#eq1-g0-59' y='0'/>
<use x='32.0738' xlink:href='#eq1-g0-100' y='0'/>
</g>
</svg> (from left to right). The exemplary arrray above is in natural order. Any R-vine array can be characterized by the diagonal entries (called order) and the entries below the diagonal of the corresponding R-vine array in natural order. Since most algorithms work with the structure in natural order, this is how <a href="classvinecopulib_1_1_r_vine_structure.html" class="m-doc">RVineStructure</a> stores the structure internally.</p>
        <section id="derived-classes">
          <h2><a href="#derived-classes">Derived classes</a></h2>
          <dl class="m-doc">
            <dt>
              class <a href="classvinecopulib_1_1_c_vine_structure.html" class="m-doc">CVineStructure</a>
            </dt>
            <dd>C-vine structures.</dd>
            <dt>
              class <a href="classvinecopulib_1_1_d_vine_structure.html" class="m-doc">DVineStructure</a>
            </dt>
            <dd>D-vine structures.</dd>
          </dl>
        </section>
        <section id="pub-static-methods">
          <h2><a href="#pub-static-methods">Public static functions</a></h2>
          <dl class="m-doc">
            <dt>
              <span class="m-doc-wrap-bumper">static auto <a href="#aff880d51e866ec2082c3330cb1e91fd6" class="m-doc">simulate</a>(</span><span class="m-doc-wrap">size_t d,
              bool natural_order = false,
              std::vector&lt;int&gt; seeds = std::vector&lt;int&gt;()) -&gt; <a href="classvinecopulib_1_1_r_vine_structure.html" class="m-doc">RVineStructure</a></span>
            </dt>
            <dd>randomly sample a regular vine structure.</dd>
          </dl>
        </section>
        <section id="typeless-methods">
          <h2><a href="#typeless-methods">Constructors, destructors, conversion operators</a></h2>
          <dl class="m-doc">
            <dt>
              <span class="m-doc-wrap-bumper"><a href="#a00a8ce5a6d6a18a2dc0b38afe4749691" class="m-doc">RVineStructure</a>(</span><span class="m-doc-wrap">const size_t&amp; d = static_cast&lt;size_t&gt;(1),
              const size_t&amp; trunc_lvl = std::numeric_limits&lt;size_t&gt;::max())</span>
            </dt>
            <dd>instantiates an <a href="classvinecopulib_1_1_r_vine_structure.html" class="m-doc">RVineStructure</a> object to a D-vine for a given dimension</dd>
            <dt>
              <span class="m-doc-wrap-bumper"><a href="#a271688bc56e2950d5a27213f4b5f9fda" class="m-doc">RVineStructure</a>(</span><span class="m-doc-wrap">const Eigen::Matrix&lt;size_t, Eigen::Dynamic, Eigen::Dynamic&gt;&amp; mat,
              bool check = true)</span>
            </dt>
            <dd>instantiates an <a href="classvinecopulib_1_1_r_vine_structure.html" class="m-doc">RVineStructure</a> object from a matrix representing an R-vine array.</dd>
            <dt>
              <span class="m-doc-wrap-bumper"><a href="#a43bf1388524c52fbd9c3598e674b8c3b" class="m-doc">RVineStructure</a>(</span><span class="m-doc-wrap">const std::vector&lt;size_t&gt;&amp; order,
              const size_t&amp; trunc_lvl = std::numeric_limits&lt;size_t&gt;::max(),
              bool check = true)</span>
            </dt>
            <dd>instantiates an <a href="classvinecopulib_1_1_r_vine_structure.html" class="m-doc">RVineStructure</a> object to a D-vine with given ordering of variables.</dd>
            <dt>
              <span class="m-doc-wrap-bumper"><a href="#af60265a40de9e6ec264cfdb35d182070" class="m-doc">RVineStructure</a>(</span><span class="m-doc-wrap">const std::vector&lt;size_t&gt;&amp; order,
              const <a href="classvinecopulib_1_1_triangular_array.html" class="m-doc">TriangularArray</a>&lt;size_t&gt;&amp; struct_array,
              bool natural_order = false,
              bool check = true)</span>
            </dt>
            <dd>instantiates an <a href="classvinecopulib_1_1_r_vine_structure.html" class="m-doc">RVineStructure</a> object from the variable order (diagonal elements of the R-vine array) and a triangular structure array (all elements above the diagonal).</dd>
            <dt>
              <span class="m-doc-wrap-bumper"><a href="#ae8e17cf0bac13c715f4dae988d801c96" class="m-doc">RVineStructure</a>(</span><span class="m-doc-wrap">const std::string filename,
              const bool check = true)</span>
            </dt>
            <dd>creates from a JSON file.</dd>
            <dt>
              <span class="m-doc-wrap-bumper"><a href="#a40373ed0f1e4875050c6d0928baa0c74" class="m-doc">RVineStructure</a>(</span><span class="m-doc-wrap">const boost::property_tree::ptree input,
              const bool check = true)</span>
            </dt>
            <dd>creates from a boost::property_tree::ptree object</dd>
          </dl>
        </section>
        <section id="pub-methods">
          <h2><a href="#pub-methods">Public functions</a></h2>
          <dl class="m-doc">
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#a174c4933d350dfe1764f3bfc2b9d2a77" class="m-doc">to_ptree</a>(</span><span class="m-doc-wrap">) const -&gt; boost::property_tree::ptree</span>
            </dt>
            <dd>converts the structure into a boost::property_tree::ptree object.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#ac0251e5a81e2eb3d31a24a7698c82cfd" class="m-doc">to_json</a>(</span><span class="m-doc-wrap">const std::string filename) const</span>
            </dt>
            <dd>write the structure into a JSON file.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#ac2cd2c83b9ffafb9c6563f1923aa1835" class="m-doc-self" name="ac2cd2c83b9ffafb9c6563f1923aa1835">get_dim</a>(</span><span class="m-doc-wrap">) const -&gt; size_t</span>
            </dt>
            <dd>extract the dimension of the vine.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#a6c691b843017f85b7067fcbe0fae55d0" class="m-doc-self" name="a6c691b843017f85b7067fcbe0fae55d0">get_trunc_lvl</a>(</span><span class="m-doc-wrap">) const -&gt; size_t</span>
            </dt>
            <dd>extract the truncation level of the vine.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#aed7d73a5bf50b95a6166f42e0f8df9a9" class="m-doc-self" name="aed7d73a5bf50b95a6166f42e0f8df9a9">get_order</a>(</span><span class="m-doc-wrap">) const -&gt; std::vector&lt;size_t&gt;</span>
            </dt>
            <dd>extract the order of variables in the vine (diagonal entries in the R-vine array).</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#a20a4e552f52dd0a35efa4b30abbcc14d" class="m-doc">get_struct_array</a>(</span><span class="m-doc-wrap">bool natural_order = false) const -&gt; <a href="classvinecopulib_1_1_triangular_array.html" class="m-doc">TriangularArray</a>&lt;size_t&gt;</span>
            </dt>
            <dd>extract structure array (all elements above the diagonal in the R-vine array).</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#aaebebea9982629eb81223d18b0b9d905" class="m-doc">get_min_array</a>(</span><span class="m-doc-wrap">) const -&gt; <a href="classvinecopulib_1_1_triangular_array.html" class="m-doc">TriangularArray</a>&lt;size_t&gt;</span>
            </dt>
            <dd>extracts the minimum array.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#ab811fb2ec4f895a9afead688da0e25c3" class="m-doc">get_needed_hfunc1</a>(</span><span class="m-doc-wrap">) const -&gt; <a href="classvinecopulib_1_1_triangular_array.html" class="m-doc">TriangularArray</a>&lt;short unsigned&gt;</span>
            </dt>
            <dd>extracts an array indicating which of the first h-functions are needed.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#ac23409bcd9d4b49d706d83fc54f0ec46" class="m-doc">get_needed_hfunc2</a>(</span><span class="m-doc-wrap">) const -&gt; <a href="classvinecopulib_1_1_triangular_array.html" class="m-doc">TriangularArray</a>&lt;short unsigned&gt;</span>
            </dt>
            <dd>extracts an array indicating which of the second h-functions are needed.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#a37325d7485875cf823c288400c351699" class="m-doc-self" name="a37325d7485875cf823c288400c351699">get_matrix</a>(</span><span class="m-doc-wrap">) const -&gt; Eigen::Matrix&lt;size_t, Eigen::Dynamic, Eigen::Dynamic&gt;</span>
            </dt>
            <dd>extract the R-vine matrix representation.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#a83ec35fc7093f6d1095f763662ece56a" class="m-doc">struct_array</a>(</span><span class="m-doc-wrap">size_t tree,
              size_t edge,
              bool natural_order = false) const -&gt; size_t</span>
            </dt>
            <dd>access elements of the structure array.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#a4c67417a03be525c7c64ebcc884b87fc" class="m-doc">min_array</a>(</span><span class="m-doc-wrap">size_t tree,
              size_t edge) const -&gt; size_t</span>
            </dt>
            <dd>access elements of the minimum array.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#a3ded308116afcef4c31bdc8150496d60" class="m-doc">needed_hfunc1</a>(</span><span class="m-doc-wrap">size_t tree,
              size_t edge) const -&gt; bool</span>
            </dt>
            <dd>access elements of the needed_hfunc1 array.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#aa56a6f1c3fb5255a0b41247ef37377ed" class="m-doc-self" name="aa56a6f1c3fb5255a0b41247ef37377ed">needed_hfunc2</a>(</span><span class="m-doc-wrap">size_t tree,
              size_t edge) const -&gt; bool</span>
            </dt>
            <dd>access elements of the needed_hfunc2 array.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#a7580c0663ac702f718944de2a0fcd1d3" class="m-doc">truncate</a>(</span><span class="m-doc-wrap">size_t trunc_lvl)</span>
            </dt>
            <dd>truncates the R-vine structure.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#a488bcaf1868f79f733e812f80445199e" class="m-doc">str</a>(</span><span class="m-doc-wrap">) const -&gt; std::string</span>
            </dt>
            <dd></dd>
          </dl>
        </section>
        <section>
          <h2>Function documentation</h2>
          <section class="m-doc-details" id="aff880d51e866ec2082c3330cb1e91fd6"><div>
            <h3>
              <span class="m-doc-wrap-bumper">static <a href="classvinecopulib_1_1_r_vine_structure.html" class="m-doc">RVineStructure</a> vinecopulib::<wbr />RVineStructure::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#aff880d51e866ec2082c3330cb1e91fd6" class="m-doc-self">simulate</a>(</span><span class="m-doc-wrap">size_t d,
              bool natural_order = false,
              std::vector&lt;int&gt; seeds = std::vector&lt;int&gt;())</span></span>
            </h3>
            <p>randomly sample a regular vine structure.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">d</td>
                  <td>the dimension.</td>
                </tr>
                <tr>
                  <td>natural_order</td>
                  <td>should the sampled structure be in natural order?</td>
                </tr>
                <tr>
                  <td>seeds</td>
                  <td>seeds of the random number generator; if empty (default), the random number generator is seeded randomly.</td>
                </tr>
              </tbody>
            </table>
<aside class="m-note m-info"><h4>Note</h4><p>Implementation of Algorithm 13 in Harry Joe&#x27;s 2014 book (p. 288), but there&#x27;s a typo: the end of line 6 in the book should be &#x27;column j&#x27; instead of &#x27;column k&#x27;.</p></aside>
          </div></section>
          <section class="m-doc-details" id="a00a8ce5a6d6a18a2dc0b38afe4749691"><div>
            <h3>
              <span class="m-doc-wrap-bumper"> vinecopulib::<wbr />RVineStructure::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a00a8ce5a6d6a18a2dc0b38afe4749691" class="m-doc-self">RVineStructure</a>(</span><span class="m-doc-wrap">const size_t&amp; d = static_cast&lt;size_t&gt;(1),
              const size_t&amp; trunc_lvl = std::numeric_limits&lt;size_t&gt;::max())</span></span>
            </h3>
            <p>instantiates an <a href="classvinecopulib_1_1_r_vine_structure.html" class="m-doc">RVineStructure</a> object to a D-vine for a given dimension</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">d</td>
                  <td>the dimension.</td>
                </tr>
                <tr>
                  <td>trunc_lvl</td>
                  <td>the truncation level. By default, it is dim - 1.</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="a271688bc56e2950d5a27213f4b5f9fda"><div>
            <h3>
              <span class="m-doc-wrap-bumper"> vinecopulib::<wbr />RVineStructure::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a271688bc56e2950d5a27213f4b5f9fda" class="m-doc-self">RVineStructure</a>(</span><span class="m-doc-wrap">const Eigen::Matrix&lt;size_t, Eigen::Dynamic, Eigen::Dynamic&gt;&amp; mat,
              bool check = true)</span></span>
            </h3>
            <p>instantiates an <a href="classvinecopulib_1_1_r_vine_structure.html" class="m-doc">RVineStructure</a> object from a matrix representing an R-vine array.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">mat</td>
                  <td>a matrix representing a valid R-vine array.</td>
                </tr>
                <tr>
                  <td>check</td>
                  <td>whether <code>mat</code> shall be checked for validity.</td>
                </tr>
              </tbody>
            </table>
<p>The matrix must contain zeros in the lower right triangle and the upper left triangle must be a valid R-vine array. Truncated vines can be encoded by putting zeros above the digonal in all rows below the truncation level. Example of a 1-truncated matrix:</p><pre class="m-code"><span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">3</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">2</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span></pre>
          </div></section>
          <section class="m-doc-details" id="a43bf1388524c52fbd9c3598e674b8c3b"><div>
            <h3>
              <span class="m-doc-wrap-bumper"> vinecopulib::<wbr />RVineStructure::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a43bf1388524c52fbd9c3598e674b8c3b" class="m-doc-self">RVineStructure</a>(</span><span class="m-doc-wrap">const std::vector&lt;size_t&gt;&amp; order,
              const size_t&amp; trunc_lvl = std::numeric_limits&lt;size_t&gt;::max(),
              bool check = true)</span></span>
            </h3>
            <p>instantiates an <a href="classvinecopulib_1_1_r_vine_structure.html" class="m-doc">RVineStructure</a> object to a D-vine with given ordering of variables.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">order</td>
                  <td>the order of variables in the D-vine (diagonal entries in the R-vine array); must be a permutation of 1, ..., d.</td>
                </tr>
                <tr>
                  <td>trunc_lvl</td>
                  <td>the truncation level. By default, it is d - 1.</td>
                </tr>
                <tr>
                  <td>check</td>
                  <td>whether `order shall be checked for validity.</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="af60265a40de9e6ec264cfdb35d182070"><div>
            <h3>
              <span class="m-doc-wrap-bumper"> vinecopulib::<wbr />RVineStructure::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#af60265a40de9e6ec264cfdb35d182070" class="m-doc-self">RVineStructure</a>(</span><span class="m-doc-wrap">const std::vector&lt;size_t&gt;&amp; order,
              const <a href="classvinecopulib_1_1_triangular_array.html" class="m-doc">TriangularArray</a>&lt;size_t&gt;&amp; struct_array,
              bool natural_order = false,
              bool check = true)</span></span>
            </h3>
            <p>instantiates an <a href="classvinecopulib_1_1_r_vine_structure.html" class="m-doc">RVineStructure</a> object from the variable order (diagonal elements of the R-vine array) and a triangular structure array (all elements above the diagonal).</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">order</td>
                  <td>the order of variables (diagonal entries in the R-vine array); must be a permutation of 1, ..., d.</td>
                </tr>
                <tr>
                  <td>struct_array</td>
                  <td>the structure array (all elements above the diagonal in the R-vine array). For truncated vines, all rows below the truncation level are omitted.</td>
                </tr>
                <tr>
                  <td>natural_order</td>
                  <td>whether <code>struct_array</code> is already in natural order.</td>
                </tr>
                <tr>
                  <td>check</td>
                  <td>whether <code>order</code> and <code>struct_array</code> shall be checked for validity.</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="ae8e17cf0bac13c715f4dae988d801c96"><div>
            <h3>
              <span class="m-doc-wrap-bumper"> vinecopulib::<wbr />RVineStructure::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#ae8e17cf0bac13c715f4dae988d801c96" class="m-doc-self">RVineStructure</a>(</span><span class="m-doc-wrap">const std::string filename,
              const bool check = true)</span></span>
            </h3>
            <p>creates from a JSON file.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">filename</td>
                  <td>the name of the JSON file to read (see <a href="classvinecopulib_1_1_r_vine_structure.html#a174c4933d350dfe1764f3bfc2b9d2a77" class="m-doc">to_<wbr />ptree()</a> for the structure of the file).</td>
                </tr>
                <tr>
                  <td>check</td>
                  <td>whether to check if the input represents a valid R-vine matrix.</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="a40373ed0f1e4875050c6d0928baa0c74"><div>
            <h3>
              <span class="m-doc-wrap-bumper"> vinecopulib::<wbr />RVineStructure::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a40373ed0f1e4875050c6d0928baa0c74" class="m-doc-self">RVineStructure</a>(</span><span class="m-doc-wrap">const boost::property_tree::ptree input,
              const bool check = true)</span></span>
            </h3>
            <p>creates from a boost::property_tree::ptree object</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">input</td>
                  <td>the boost::property_tree::ptree object to convert from (see <a href="classvinecopulib_1_1_r_vine_structure.html#a174c4933d350dfe1764f3bfc2b9d2a77" class="m-doc">to_<wbr />ptree()</a> for the structure of the input).</td>
                </tr>
                <tr>
                  <td>check</td>
                  <td>whether to check if the input represents a valid R-vine structure.</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="a174c4933d350dfe1764f3bfc2b9d2a77"><div>
            <h3>
              <span class="m-doc-wrap-bumper">boost::property_tree::ptree vinecopulib::<wbr />RVineStructure::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a174c4933d350dfe1764f3bfc2b9d2a77" class="m-doc-self">to_ptree</a>(</span><span class="m-doc-wrap">) const</span></span>
            </h3>
            <p>converts the structure into a boost::property_tree::ptree object.</p>
            <table class="m-table m-fullwidth m-flat">
              <tfoot>
                <tr>
                  <th style="width: 1%">Returns</th>
                  <td>the boost::property_tree::ptree object containing the structure.</td>
                </tr>
              </tfoot>
            </table>
<p>The <code>ptree</code> object contains two nodes: <code>&quot;array&quot;</code> for the structure triangular array and <code>&quot;order&quot;</code> for the order vector.</p>
          </div></section>
          <section class="m-doc-details" id="ac0251e5a81e2eb3d31a24a7698c82cfd"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void vinecopulib::<wbr />RVineStructure::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#ac0251e5a81e2eb3d31a24a7698c82cfd" class="m-doc-self">to_json</a>(</span><span class="m-doc-wrap">const std::string filename) const</span></span>
            </h3>
            <p>write the structure into a JSON file.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">filename</td>
                  <td>the name of the file to write.</td>
                </tr>
              </tbody>
            </table>
<p>See <a href="classvinecopulib_1_1_r_vine_structure.html#a174c4933d350dfe1764f3bfc2b9d2a77" class="m-doc">to_<wbr />ptree()</a> for the structure of the file.</p>
          </div></section>
          <section class="m-doc-details" id="a20a4e552f52dd0a35efa4b30abbcc14d"><div>
            <h3>
              <span class="m-doc-wrap-bumper"><a href="classvinecopulib_1_1_triangular_array.html" class="m-doc">TriangularArray</a>&lt;size_t&gt; vinecopulib::<wbr />RVineStructure::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a20a4e552f52dd0a35efa4b30abbcc14d" class="m-doc-self">get_struct_array</a>(</span><span class="m-doc-wrap">bool natural_order = false) const</span></span>
            </h3>
            <p>extract structure array (all elements above the diagonal in the R-vine array).</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">natural_order</td>
                  <td>whether indices correspond to natural order.</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="aaebebea9982629eb81223d18b0b9d905"><div>
            <h3>
              <span class="m-doc-wrap-bumper"><a href="classvinecopulib_1_1_triangular_array.html" class="m-doc">TriangularArray</a>&lt;size_t&gt; vinecopulib::<wbr />RVineStructure::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#aaebebea9982629eb81223d18b0b9d905" class="m-doc-self">get_min_array</a>(</span><span class="m-doc-wrap">) const</span></span>
            </h3>
            <p>extracts the minimum array.</p>
<p>The minimum array is derived from an R-vine array by iteratively computing the (elementwise) minimum of two subsequent rows (starting from the top). It is used in estimation and evaluation algorithms to find the two edges in the previous tree that are joined by the current edge.</p>
          </div></section>
          <section class="m-doc-details" id="ab811fb2ec4f895a9afead688da0e25c3"><div>
            <h3>
              <span class="m-doc-wrap-bumper"><a href="classvinecopulib_1_1_triangular_array.html" class="m-doc">TriangularArray</a>&lt;short unsigned&gt; vinecopulib::<wbr />RVineStructure::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#ab811fb2ec4f895a9afead688da0e25c3" class="m-doc-self">get_needed_hfunc1</a>(</span><span class="m-doc-wrap">) const</span></span>
            </h3>
            <p>extracts an array indicating which of the first h-functions are needed.</p>
<p>(it is usually not necessary to compute both h-functions for each pair-copula).</p>
          </div></section>
          <section class="m-doc-details" id="ac23409bcd9d4b49d706d83fc54f0ec46"><div>
            <h3>
              <span class="m-doc-wrap-bumper"><a href="classvinecopulib_1_1_triangular_array.html" class="m-doc">TriangularArray</a>&lt;short unsigned&gt; vinecopulib::<wbr />RVineStructure::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#ac23409bcd9d4b49d706d83fc54f0ec46" class="m-doc-self">get_needed_hfunc2</a>(</span><span class="m-doc-wrap">) const</span></span>
            </h3>
            <p>extracts an array indicating which of the second h-functions are needed.</p>
<p>(it is usually not necessary to compute both h-functions for each pair-copula).</p>
          </div></section>
          <section class="m-doc-details" id="a83ec35fc7093f6d1095f763662ece56a"><div>
            <h3>
              <span class="m-doc-wrap-bumper">size_t vinecopulib::<wbr />RVineStructure::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a83ec35fc7093f6d1095f763662ece56a" class="m-doc-self">struct_array</a>(</span><span class="m-doc-wrap">size_t tree,
              size_t edge,
              bool natural_order = false) const</span></span>
            </h3>
            <p>access elements of the structure array.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">tree</td>
                  <td>tree index.</td>
                </tr>
                <tr>
                  <td>edge</td>
                  <td>edge index.</td>
                </tr>
                <tr>
                  <td>natural_order</td>
                  <td>whether indices correspond to natural order.</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="a4c67417a03be525c7c64ebcc884b87fc"><div>
            <h3>
              <span class="m-doc-wrap-bumper">size_t vinecopulib::<wbr />RVineStructure::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a4c67417a03be525c7c64ebcc884b87fc" class="m-doc-self">min_array</a>(</span><span class="m-doc-wrap">size_t tree,
              size_t edge) const</span></span>
            </h3>
            <p>access elements of the minimum array.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">tree</td>
                  <td>tree index.</td>
                </tr>
                <tr>
                  <td>edge</td>
                  <td>edge index.</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="a3ded308116afcef4c31bdc8150496d60"><div>
            <h3>
              <span class="m-doc-wrap-bumper">bool vinecopulib::<wbr />RVineStructure::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a3ded308116afcef4c31bdc8150496d60" class="m-doc-self">needed_hfunc1</a>(</span><span class="m-doc-wrap">size_t tree,
              size_t edge) const</span></span>
            </h3>
            <p>access elements of the needed_hfunc1 array.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">tree</td>
                  <td>tree index.</td>
                </tr>
                <tr>
                  <td>edge</td>
                  <td>edge index.</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="a7580c0663ac702f718944de2a0fcd1d3"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void vinecopulib::<wbr />RVineStructure::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a7580c0663ac702f718944de2a0fcd1d3" class="m-doc-self">truncate</a>(</span><span class="m-doc-wrap">size_t trunc_lvl)</span></span>
            </h3>
            <p>truncates the R-vine structure.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">trunc_lvl</td>
                  <td>the truncation level.</td>
                </tr>
              </tbody>
            </table>
<p>If the structure is already truncated at a level less than <code>trunc_lvl</code>, the function does nothing.</p>
          </div></section>
          <section class="m-doc-details" id="a488bcaf1868f79f733e812f80445199e"><div>
            <h3>
              <span class="m-doc-wrap-bumper">std::string vinecopulib::<wbr />RVineStructure::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a488bcaf1868f79f733e812f80445199e" class="m-doc-self">str</a>(</span><span class="m-doc-wrap">) const</span></span>
            </h3>
<p>converts the structure to a string representation (most useful for printing).</p>
          </div></section>
        </section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>

          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search.js"></script>
<script src="searchdata.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>vinecopulib A C++ library for vine copulas. Created by <a href="https://doxygen.org/">Doxygen</a> 1.8.13 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
